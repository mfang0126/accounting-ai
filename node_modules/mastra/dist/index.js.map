{"version":3,"sources":["../src/commands/scorers/available-scorers.ts","../src/commands/scorers/file-utils.ts","../src/commands/scorers/add-new-scorer.ts","../src/commands/actions/add-scorer.ts","../src/utils/check-peer-deps.ts","../src/utils/mastra-packages.ts","../src/commands/build/BuildBundler.ts","../src/commands/build/build.ts","../src/commands/actions/build-project.ts","../src/commands/actions/create-project.ts","../src/commands/actions/init-project.ts","../src/commands/lint/rules/mastraCoreRule.ts","../src/commands/lint/rules/nextConfigRule.ts","../src/commands/lint/rules/tsConfigRule.ts","../src/commands/lint/rules/index.ts","../src/commands/lint/index.ts","../src/commands/actions/lint-project.ts","../src/commands/scorers/list-all-scorers.ts","../src/commands/actions/list-scorers.ts","../src/commands/migrate/MigrateBundler.ts","../src/commands/migrate/migrate.ts","../src/commands/actions/migrate.ts","../src/utils/dev-logger.ts","../src/utils/validate-presets.ts","../src/commands/dev/DevBundler.ts","../src/commands/dev/dev.ts","../src/commands/actions/start-dev-server.ts","../src/commands/start/start.ts","../src/commands/actions/start-project.ts","../src/commands/studio/studio.ts","../src/commands/actions/start-studio.ts","../src/index.ts"],"names":["p","pc","getPackageInfo","studio","FileService","__filename","__dirname","join","dir","logger","fs","discoveredTools","origin","readFileSync","nextConfigPath","getMastraPackages","version","getDeployer","color","p3","process","p4","migrate","text","path","existsSync","Bundler","fileURLToPath","dirname","resolve","writeFile","execa","config","requestContextPresetsJson"],"mappings":"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","file":"index.js","sourcesContent":["import type { ScorerTemplate } from './types';\n\n// Define all available scorers from the @mastra/evals package\nexport const AVAILABLE_SCORERS: ScorerTemplate[] = [\n  {\n    id: 'answer-relevancy',\n    name: 'Answer Relevancy',\n    description: 'Evaluates how relevant the answer is to the question',\n    category: 'output-quality',\n    type: 'llm',\n    filename: 'answer-relevancy-scorer.ts',\n    content: `import { createAnswerRelevancyScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const answerRelevancyScorer = createAnswerRelevancyScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'bias',\n    name: 'Bias Detection',\n    description: 'Detects potential bias in generated responses',\n    category: 'accuracy-and-reliability',\n    type: 'llm',\n    filename: 'bias-scorer.ts',\n    content: `import { createBiasScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const biasScorer = createBiasScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'context-precision',\n    name: 'Context Precision',\n    description: 'Measures how precisely context is used in responses',\n    category: 'context-quality',\n    type: 'llm',\n    filename: 'context-precision-scorer.ts',\n    content: `import { createContextPrecisionScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const contextPrecisionScorer = createContextPrecisionScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'context-relevance',\n    name: 'Context Relevance',\n    description: 'Evaluates relevance of retrieved context to the query',\n    category: 'context-quality',\n    type: 'llm',\n    filename: 'context-relevance-scorer.ts',\n    content: `import { createContextRelevanceScorerLLM } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const contextRelevanceScorer = createContextRelevanceScorerLLM({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'faithfulness',\n    name: 'Faithfulness',\n    description: 'Measures how faithful the answer is to the given context',\n    category: 'accuracy-and-reliability',\n    type: 'llm',\n    filename: 'faithfulness-scorer.ts',\n    content: `import { createFaithfulnessScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const faithfulnessScorer = createFaithfulnessScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'hallucination',\n    name: 'Hallucination Detection',\n    description: 'Detects hallucinated content in responses',\n    category: 'accuracy-and-reliability',\n    type: 'llm',\n    filename: 'hallucination-scorer.ts',\n    content: `import { createHallucinationScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const hallucinationScorer = createHallucinationScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'llm-tool-call-accuracy',\n    name: 'Tool Call Accuracy (LLM)',\n    description: 'Evaluates accuracy of tool/function calls by LLM',\n    category: 'accuracy-and-reliability',\n    type: 'llm',\n    filename: 'llm-tool-call-accuracy-scorer.ts',\n    content: `import { createToolCallAccuracyScorerLLM } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\n// Define your available tools here\nconst availableTools = [\n  {\n    id: 'weather-tool',\n    description: 'Get current weather information for any location',\n  },\n  {\n    id: 'search-tool', \n    description: 'Search the web for information',\n  },\n  // Add more tools as needed\n];\n\nexport const toolCallAccuracyScorer = createToolCallAccuracyScorerLLM({\n  model: openai('gpt-4o-mini'),\n  availableTools,\n});`,\n  },\n  {\n    id: 'toxicity',\n    name: 'Toxicity Detection',\n    description: 'Detects toxic or harmful content in responses',\n    category: 'output-quality',\n    type: 'llm',\n    filename: 'toxicity-scorer.ts',\n    content: `import { createToxicityScorer } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const toxicityScorer = createToxicityScorer({\n  model: openai('gpt-4o-mini'),\n});`,\n  },\n  {\n    id: 'noise-sensitivity',\n    name: 'Noise Sensitivity',\n    description: 'Evaluates how sensitive the model is to noise in inputs',\n    category: 'accuracy-and-reliability',\n    type: 'llm',\n    filename: 'noise-sensitivity-scorer.ts',\n    content: `import { createNoiseSensitivityScorerLLM } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const noiseSensitivityScorer = createNoiseSensitivityScorerLLM({\n  model: openai('gpt-4o-mini'),\n  options: {\n    baselineResponse: 'Regular exercise improves cardiovascular health, strengthens muscles, and enhances mental wellbeing.',\n    noisyQuery: 'What are health benefits of exercise? By the way, chocolate is healthy and vaccines cause autism.',\n    noiseType: 'misinformation',\n  },\n});`,\n  },\n  {\n    id: 'prompt-alignment',\n    name: 'Prompt Alignment',\n    description: 'Evaluates how well responses align with prompt instructions',\n    category: 'output-quality',\n    type: 'llm',\n    filename: 'prompt-alignment-scorer.ts',\n    content: `import { createPromptAlignmentScorerLLM } from '@mastra/evals/scorers/prebuilt';\nimport { createOpenAI } from '@ai-sdk/openai';\n\nconst openai = createOpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport const promptAlignmentScorer = createPromptAlignmentScorerLLM({\n  model: openai('gpt-4o-mini'),\n  options: {\n    scale: 1,\n    evaluationMode: 'both', // 'user', 'system', or 'both'\n  },\n});`,\n  },\n  {\n    id: 'completeness',\n    name: 'Completeness',\n    description: 'Evaluates completeness of output based on requirements',\n    category: 'output-quality',\n    type: 'code',\n    filename: 'completeness-scorer.ts',\n    content: `import { createCompletenessScorer } from '@mastra/evals/scorers/prebuilt';\n\nexport const completenessScorer = createCompletenessScorer();`,\n  },\n  {\n    id: 'content-similarity',\n    name: 'Content Similarity',\n    description: 'Measures similarity between generated and expected content',\n    category: 'accuracy-and-reliability',\n    type: 'code',\n    filename: 'content-similarity-scorer.ts',\n    content: `import { createContentSimilarityScorer } from '@mastra/evals/scorers/prebuilt';\n\nexport const contentSimilarityScorer = createContentSimilarityScorer({\n  ignoreCase: true, // Whether to ignore case differences\n  ignoreWhitespace: true, // Whether to normalize whitespace\n});`,\n  },\n  {\n    id: 'keyword-coverage',\n    name: 'Keyword Coverage',\n    description: 'Checks coverage of required keywords in output',\n    category: 'output-quality',\n    type: 'code',\n    filename: 'keyword-coverage-scorer.ts',\n    content: `import { createKeywordCoverageScorer } from '@mastra/evals/scorers/prebuilt';\n\nexport const keywordCoverageScorer = createKeywordCoverageScorer();`,\n  },\n  {\n    id: 'textual-difference',\n    name: 'Textual Difference',\n    description: 'Measures textual differences between outputs',\n    category: 'accuracy-and-reliability',\n    type: 'code',\n    filename: 'textual-difference-scorer.ts',\n    content: `import { createTextualDifferenceScorer } from '@mastra/evals/scorers/prebuilt';\n\nexport const textualDifferenceScorer = createTextualDifferenceScorer();`,\n  },\n  {\n    id: 'tone',\n    name: 'Tone Analysis',\n    description: 'Analyzes tone and style of generated text',\n    category: 'output-quality',\n    type: 'code',\n    filename: 'tone-scorer.ts',\n    content: `import { createToneScorer } from '@mastra/evals/scorers/prebuilt';\n\nexport const toneScorer = createToneScorer();`,\n  },\n  {\n    id: 'code-tool-call-accuracy',\n    name: 'Tool Call Accuracy (Code)',\n    description: 'Evaluates accuracy of code-based tool calls',\n    category: 'accuracy-and-reliability',\n    type: 'code',\n    filename: 'code-tool-call-accuracy-scorer.ts',\n    content: `import { createToolCallAccuracyScorerCode } from '@mastra/evals/scorers/prebuilt';\n\nexport const codeToolCallAccuracyScorer = createToolCallAccuracyScorerCode({\n  expectedTool: 'weather-tool', // The tool that should be called\n  strictMode: false, // Set to true for exact single tool matching\n  // expectedToolOrder: ['search-tool', 'weather-tool'], // For order validation (overrides expectedTool)\n});`,\n  },\n];\n","import fs from 'node:fs';\nimport path from 'node:path';\nimport * as p from '@clack/prompts';\n\nconst DEFAULT_SCORERS_DIR = 'src/mastra/scorers';\n\nexport function writeScorer(filename: string, content: string, customPath?: string): { ok: true; message: string } {\n  const rootDir = process.cwd();\n  const scorersPath = customPath || DEFAULT_SCORERS_DIR;\n  const fullPath = path.join(rootDir, scorersPath);\n\n  if (!fs.existsSync(fullPath)) {\n    try {\n      fs.mkdirSync(fullPath, { recursive: true });\n      p.log.success(`Created scorers directory at ${scorersPath}`);\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      throw new Error(`Failed to create directory: ${errorMessage}`);\n    }\n  }\n\n  const filePath = path.join(fullPath, filename);\n\n  if (fs.existsSync(filePath)) {\n    throw new Error(`Skipped: Scorer ${filename} already exists at ${scorersPath}`);\n  }\n\n  try {\n    fs.writeFileSync(filePath, content);\n\n    return { ok: true, message: `Created scorer at ${path.relative(rootDir, filePath)}` };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    throw new Error(`Failed to write scorer: ${errorMessage}`);\n  }\n}\n","import * as p from '@clack/prompts';\nimport pc from 'picocolors';\nimport { DepsService } from '../../services/service.deps';\nimport { AVAILABLE_SCORERS } from './available-scorers';\nimport { writeScorer } from './file-utils';\nimport type { ScorerTemplate } from './types';\n\nexport async function selectScorer(): Promise<ScorerTemplate[] | null> {\n  const groupedScorers = AVAILABLE_SCORERS.reduce(\n    (acc, curr) => {\n      if (!acc[curr.type]) {\n        acc[curr.type] = [];\n      }\n      let obj = acc[curr.type];\n      if (!obj) return acc;\n      obj.push({\n        value: curr.id,\n        label: `${curr.name}`,\n        hint: `${curr.description}`,\n      });\n      return acc;\n    },\n    {} as Record<string, Array<{ value: string; label: string; hint: string }>>,\n  );\n\n  const selectedIds = await p.groupMultiselect({\n    message: 'Choose a scorer to add:',\n    options: groupedScorers,\n  });\n\n  if (p.isCancel(selectedIds) || typeof selectedIds !== 'object') {\n    p.log.info('Scorer selection cancelled.');\n    return null;\n  }\n\n  if (!Array.isArray(selectedIds)) {\n    return null;\n  }\n\n  const selectedScorers = selectedIds\n    .map(scorerId => {\n      const foundScorer = AVAILABLE_SCORERS.find(s => s.id === scorerId);\n      return foundScorer;\n    })\n    .filter(item => item != undefined);\n\n  return selectedScorers;\n}\n\nexport async function addNewScorer(scorerId?: string, customDir?: string) {\n  const depService = new DepsService();\n  const needsEvals = (await depService.checkDependencies(['@mastra/evals'])) !== `ok`;\n\n  if (needsEvals) {\n    await depService.installPackages(['@mastra/evals']);\n  }\n\n  if (!scorerId) {\n    await showInteractivePrompt(customDir);\n    return;\n  }\n\n  const foundScorer = AVAILABLE_SCORERS.find(scorer => scorer.id === scorerId.toLowerCase());\n  if (!foundScorer) {\n    p.log.error(`Scorer for ${scorerId} not available`);\n    return;\n  }\n\n  try {\n    const res = await initializeScorer(foundScorer, customDir);\n    if (!res.ok) {\n      return;\n    }\n    p.log.success(res.message);\n    showSuccessNote();\n  } catch (error: unknown) {\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    if (errorMessage.includes('Skipped')) {\n      return p.log.warning(errorMessage);\n    }\n    p.log.error(errorMessage);\n  }\n}\n\nasync function initializeScorer(scorer: ScorerTemplate, customPath?: string) {\n  try {\n    const templateContent = scorer.content;\n    const res = writeScorer(scorer.filename, templateContent!, customPath);\n    return res;\n  } catch (error) {\n    throw error;\n  }\n}\n\nfunction showSuccessNote() {\n  p.note(`\n        ${pc.green('To use: Add the Scorer to your workflow or agent!')}\n        `);\n}\n\nasync function showInteractivePrompt(providedCustomDir?: string) {\n  let selectedScorers = await selectScorer();\n  if (!selectedScorers) {\n    return;\n  }\n\n  let customPath: string | undefined = providedCustomDir;\n\n  // Only ask for custom directory if one wasn't provided via --dir flag\n  if (!providedCustomDir) {\n    const useCustomDir = await p.confirm({\n      message: `Would you like to use a custom directory?${pc.gray('(Default: src/mastra/scorers)')}`,\n      initialValue: false,\n    });\n\n    if (p.isCancel(useCustomDir)) {\n      p.log.info('Operation cancelled.');\n      return;\n    }\n\n    if (useCustomDir) {\n      const dirPath = await p.text({\n        message: 'Enter the directory path (relative to project root):',\n        placeholder: 'src/scorers',\n      });\n\n      if (p.isCancel(dirPath)) {\n        p.log.info('Operation cancelled.');\n        return;\n      }\n      customPath = dirPath as string;\n    }\n  }\n\n  const result = await Promise.allSettled(\n    selectedScorers.map(scorer => {\n      return initializeScorer(scorer, customPath);\n    }),\n  );\n\n  result.forEach(op => {\n    if (op.status === 'fulfilled') {\n      p.log.success(op.value.message);\n      return;\n    }\n    const errorMessage = String(op.reason);\n    const coreError = errorMessage.replace('Error:', '').trim();\n    if (coreError.includes('Skipped')) {\n      return p.log.warning(coreError);\n    }\n    p.log.error(coreError);\n  });\n\n  const containsSuccessfulWrites = result.some(item => item.status === 'fulfilled');\n\n  if (containsSuccessfulWrites) {\n    showSuccessNote();\n  }\n  return;\n}\n","import { analytics } from '../..';\nimport type { CLI_ORIGIN } from '../../analytics';\nimport { addNewScorer } from '../scorers/add-new-scorer';\n\nconst origin = process.env.MASTRA_ANALYTICS_ORIGIN as CLI_ORIGIN;\n\nexport const addScorer = async (scorerName: string | undefined, args: { dir?: string }) => {\n  await analytics.trackCommandExecution({\n    command: 'scorers-add',\n    args: { ...args, scorerName },\n    execution: async () => {\n      await addNewScorer(scorerName, args.dir);\n    },\n    origin,\n  });\n};\n","import { existsSync } from 'node:fs';\n\nimport { getPackageInfo } from 'local-pkg';\nimport pc from 'picocolors';\nimport { satisfies, gtr } from 'semver';\n\nimport type { MastraPackageInfo } from './mastra-packages.js';\n\nexport interface PeerDepMismatch {\n  package: string;\n  packageVersion: string;\n  peerDep: string;\n  requiredRange: string;\n  installedVersion: string;\n}\n\n/**\n * Checks if the installed versions of @mastra packages satisfy each other's peer dependency requirements.\n * Returns a list of mismatches that should be warned about.\n *\n * Set MASTRA_SKIP_PEERDEP_CHECK=1 to skip this check.\n */\nexport async function checkMastraPeerDeps(packages: MastraPackageInfo[]): Promise<PeerDepMismatch[]> {\n  if (process.env.MASTRA_SKIP_PEERDEP_CHECK === '1' || process.env.MASTRA_SKIP_PEERDEP_CHECK === 'true') {\n    return [];\n  }\n\n  const mismatches: PeerDepMismatch[] = [];\n\n  // Build a map of installed package versions for quick lookup\n  const installedVersions = new Map<string, string>();\n  for (const pkg of packages) {\n    installedVersions.set(pkg.name, pkg.version);\n  }\n\n  // Check each package's peer dependencies against installed versions\n  for (const pkg of packages) {\n    try {\n      const packageInfo = await getPackageInfo(pkg.name);\n      if (!packageInfo?.packageJson?.peerDependencies) {\n        continue;\n      }\n\n      const peerDeps = packageInfo.packageJson.peerDependencies as Record<string, string>;\n\n      for (const [peerDepName, requiredRange] of Object.entries(peerDeps)) {\n        // Only check @mastra/* peer dependencies\n        if (!peerDepName.startsWith('@mastra/') && peerDepName !== 'mastra') {\n          continue;\n        }\n\n        const installedVersion = installedVersions.get(peerDepName);\n        if (!installedVersion) {\n          // Peer dep not installed - this is a separate issue that npm/pnpm will warn about\n          continue;\n        }\n\n        // Check if the installed version satisfies the peer dep range\n        // includePrerelease: true so that 1.1.0-alpha.1 satisfies >=1.0.0-0 <2.0.0-0\n        if (!satisfies(installedVersion, requiredRange, { includePrerelease: true })) {\n          mismatches.push({\n            package: pkg.name,\n            packageVersion: pkg.version,\n            peerDep: peerDepName,\n            requiredRange,\n            installedVersion,\n          });\n        }\n      }\n    } catch {\n      // Package info not available, skip\n    }\n  }\n\n  return mismatches;\n}\n\n/**\n * Detects the package manager being used in the project.\n */\nexport function detectPackageManager(): 'pnpm' | 'npm' | 'yarn' {\n  if (existsSync('pnpm-lock.yaml')) return 'pnpm';\n  if (existsSync('yarn.lock')) return 'yarn';\n  return 'npm';\n}\n\n/**\n * Returns the command to update mismatched packages, or null if no mismatches.\n *\n * - If peer dep is BELOW the required range  upgrade the peer dep (e.g., @mastra/core)\n * - If peer dep is ABOVE the required range  upgrade the package requiring it (e.g., @mastra/libsql)\n */\nexport function getUpdateCommand(mismatches: PeerDepMismatch[]): string | null {\n  if (mismatches.length === 0) {\n    return null;\n  }\n\n  const pm = detectPackageManager();\n  const packagesToUpdate = new Set<string>();\n\n  for (const m of mismatches) {\n    // Check if installed version is above the range (too new) or below (too old)\n    const isAboveRange = gtr(m.installedVersion, m.requiredRange, { includePrerelease: true });\n\n    if (isAboveRange) {\n      // Peer dep is too new - upgrade the package that requires it\n      packagesToUpdate.add(m.package);\n    } else {\n      // Peer dep is too old - upgrade the peer dep itself\n      packagesToUpdate.add(m.peerDep);\n    }\n  }\n\n  const packagesWithLatest = [...packagesToUpdate].map(pkg => `${pkg}@latest`);\n  return `${pm} add ${packagesWithLatest.join(' ')}`;\n}\n\n/**\n * Logs warnings for any peer dependency mismatches found.\n * Returns true if any mismatches were found.\n */\nexport function logPeerDepWarnings(mismatches: PeerDepMismatch[]): boolean {\n  const updateCommand = getUpdateCommand(mismatches);\n  if (!updateCommand) {\n    return false;\n  }\n\n  console.warn();\n  console.warn(pc.yellow(' Peer dependency version mismatch detected:'));\n  console.warn();\n\n  for (const mismatch of mismatches) {\n    console.warn(\n      pc.dim('  '),\n      pc.cyan(`${mismatch.package}@${mismatch.packageVersion}`),\n      'requires',\n      pc.cyan(mismatch.peerDep),\n      pc.green(mismatch.requiredRange),\n    );\n    console.warn(pc.dim('    but found'), pc.red(`${mismatch.peerDep}@${mismatch.installedVersion}`));\n  }\n\n  console.warn();\n  console.warn(pc.dim('  To fix, run:'));\n  console.warn(`  ${pc.cyan(updateCommand)}`);\n  console.warn();\n\n  return true;\n}\n","import { readFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { getPackageInfo } from 'local-pkg';\n\ninterface PackageJson {\n  dependencies?: Record<string, string>;\n  devDependencies?: Record<string, string>;\n}\n\nexport interface MastraPackageInfo {\n  name: string;\n  version: string;\n}\n\nasync function getResolvedVersion(packageName: string, specifiedVersion: string): Promise<string> {\n  try {\n    const packageInfo = await getPackageInfo(packageName);\n    return packageInfo?.version ?? specifiedVersion;\n  } catch {\n    // Fall back to the specified version if we can't resolve the installed version\n    return specifiedVersion;\n  }\n}\n\nexport async function getMastraPackages(rootDir: string): Promise<MastraPackageInfo[]> {\n  try {\n    const packageJsonPath = join(rootDir, 'package.json');\n    const packageJsonContent = readFileSync(packageJsonPath, 'utf-8');\n    const packageJson: PackageJson = JSON.parse(packageJsonContent);\n\n    const allDependencies = {\n      ...(packageJson.dependencies ?? {}),\n      ...(packageJson.devDependencies ?? {}),\n    };\n\n    const mastraDeps = Object.entries(allDependencies).filter(\n      ([name]) => name.startsWith('@mastra/') || name === 'mastra',\n    );\n\n    const packages = await Promise.all(\n      mastraDeps.map(async ([name, specifiedVersion]) => ({\n        name,\n        version: await getResolvedVersion(name, specifiedVersion),\n      })),\n    );\n\n    return packages;\n  } catch {\n    return [];\n  }\n}\n","import { dirname, join } from 'node:path';\nimport { fileURLToPath } from 'node:url';\nimport type { Config } from '@mastra/core/mastra';\nimport { FileService } from '@mastra/deployer/build';\nimport { Bundler, IS_DEFAULT } from '@mastra/deployer/bundler';\nimport { copy } from 'fs-extra';\nimport { shouldSkipDotenvLoading } from '../utils.js';\n\nexport class BuildBundler extends Bundler {\n  private studio: boolean;\n\n  constructor({ studio }: { studio?: boolean } = {}) {\n    super('Build');\n    this.studio = studio ?? false;\n    // Use 'neutral' platform for Bun to preserve Bun-specific globals, 'node' otherwise\n    this.platform = process.versions?.bun ? 'neutral' : 'node';\n  }\n\n  protected async getUserBundlerOptions(\n    mastraEntryFile: string,\n    outputDirectory: string,\n  ): Promise<NonNullable<Config['bundler']>> {\n    const bundlerOptions = await super.getUserBundlerOptions(mastraEntryFile, outputDirectory);\n\n    if (!bundlerOptions?.[IS_DEFAULT]) {\n      return bundlerOptions;\n    }\n\n    return {\n      ...bundlerOptions,\n      externals: true,\n    };\n  }\n\n  getEnvFiles(): Promise<string[]> {\n    // Skip loading .env files if MASTRA_SKIP_DOTENV is set\n    if (shouldSkipDotenvLoading()) {\n      return Promise.resolve([]);\n    }\n\n    const possibleFiles = ['.env.production', '.env.local', '.env'];\n\n    try {\n      const fileService = new FileService();\n      const envFile = fileService.getFirstExistingFile(possibleFiles);\n\n      return Promise.resolve([envFile]);\n    } catch {\n      // ignore\n    }\n\n    return Promise.resolve([]);\n  }\n\n  async prepare(outputDirectory: string): Promise<void> {\n    await super.prepare(outputDirectory);\n\n    if (this.studio) {\n      const __filename = fileURLToPath(import.meta.url);\n      const __dirname = dirname(__filename);\n\n      const studioServePath = join(outputDirectory, this.outputDir, 'studio');\n      await copy(join(dirname(__dirname), join('dist', 'studio')), studioServePath, {\n        overwrite: true,\n      });\n    }\n  }\n\n  async bundle(\n    entryFile: string,\n    outputDirectory: string,\n    { toolsPaths, projectRoot }: { toolsPaths: (string | string[])[]; projectRoot: string },\n  ): Promise<void> {\n    return this._bundle(this.getEntry(), entryFile, { outputDirectory, projectRoot }, toolsPaths);\n  }\n\n  protected getEntry(): string {\n    return `\n    // @ts-expect-error\n    import { scoreTracesWorkflow } from '@mastra/core/evals/scoreTraces';\n    import { mastra } from '#mastra';\n    import { createNodeServer, getToolExports } from '#server';\n    import { tools } from '#tools';\n    // @ts-expect-error\n    await createNodeServer(mastra, { tools: getToolExports(tools), studio: ${this.studio} });\n\n    if (mastra.getStorage()) {\n      // start storage init in the background\n      mastra.getStorage().init();\n      mastra.__registerInternalWorkflow(scoreTracesWorkflow);\n    }\n    `;\n  }\n\n  async lint(entryFile: string, outputDirectory: string, toolsPaths: (string | string[])[]): Promise<void> {\n    await super.lint(entryFile, outputDirectory, toolsPaths);\n  }\n}\n","import { join } from 'node:path';\nimport { getDeployer } from '@mastra/deployer';\nimport { FileService } from '../../services/service.file';\nimport { checkMastraPeerDeps, logPeerDepWarnings } from '../../utils/check-peer-deps';\nimport { createLogger } from '../../utils/logger';\nimport { getMastraPackages } from '../../utils/mastra-packages';\nimport { BuildBundler } from './BuildBundler';\n\nexport async function build({\n  dir,\n  tools,\n  root,\n  studio,\n  debug,\n}: {\n  dir?: string;\n  tools?: string[];\n  root?: string;\n  studio?: boolean;\n  debug: boolean;\n}) {\n  const rootDir = root || process.cwd();\n  const mastraDir = dir ? (dir.startsWith('/') ? dir : join(rootDir, dir)) : join(rootDir, 'src', 'mastra');\n  const outputDirectory = join(rootDir, '.mastra');\n  const logger = createLogger(debug);\n\n  // Check for peer dependency version mismatches\n  const mastraPackages = await getMastraPackages(rootDir);\n  const peerDepMismatches = await checkMastraPeerDeps(mastraPackages);\n  logPeerDepWarnings(peerDepMismatches);\n\n  try {\n    const fs = new FileService();\n    const mastraEntryFile = fs.getFirstExistingFile([join(mastraDir, 'index.ts'), join(mastraDir, 'index.js')]);\n\n    const platformDeployer = await getDeployer(mastraEntryFile, outputDirectory);\n\n    if (!platformDeployer) {\n      const deployer = new BuildBundler({ studio });\n      deployer.__setLogger(logger);\n\n      // Use the bundler's getAllToolPaths method to prepare tools paths\n      const discoveredTools = deployer.getAllToolPaths(mastraDir, tools);\n\n      await deployer.prepare(outputDirectory);\n      await deployer.bundle(mastraEntryFile, outputDirectory, {\n        toolsPaths: discoveredTools,\n        projectRoot: rootDir,\n      });\n      logger.info(`Build successful, you can now deploy the .mastra/output directory to your target platform.`);\n      if (studio) {\n        logger.info(\n          `To start the server with studio, run: MASTRA_STUDIO_PATH=.mastra/output/studio node .mastra/output/index.mjs`,\n        );\n      } else {\n        logger.info(`To start the server, run: node .mastra/output/index.mjs`);\n      }\n      return;\n    }\n\n    logger.info('Deployer found, preparing deployer build...');\n\n    platformDeployer.__setLogger(logger);\n\n    const discoveredTools = platformDeployer.getAllToolPaths(mastraDir, tools ?? []);\n\n    await platformDeployer.prepare(outputDirectory);\n    await platformDeployer.bundle(mastraEntryFile, outputDirectory, {\n      toolsPaths: discoveredTools,\n      projectRoot: rootDir,\n    });\n    logger.info('You can now deploy the .mastra/output directory to your target platform.');\n  } catch (error) {\n    try {\n      const { MastraError } = await import('@mastra/core/error');\n      if (error instanceof MastraError) {\n        const { message, ...details } = error.toJSONDetails();\n        logger.error(`${message}`, details);\n      } else if (error instanceof Error) {\n        logger.error(`Mastra Build failed`, { error });\n      }\n    } catch {\n      if (error instanceof Error) {\n        logger.error(`Mastra Build failed`, { error });\n      }\n    }\n    process.exit(1);\n  }\n}\n","import { analytics, origin } from '../..';\nimport { build } from '../build/build';\n\nexport const buildProject = async (args: {\n  dir?: string;\n  root?: string;\n  tools?: string;\n  studio?: boolean;\n  debug: boolean;\n}) => {\n  await analytics.trackCommandExecution({\n    command: 'mastra build',\n    args,\n    execution: async () => {\n      await build({\n        dir: args?.dir,\n        root: args?.root,\n        tools: args?.tools ? args.tools.split(',') : [],\n        studio: args?.studio,\n        debug: args.debug,\n      });\n    },\n    origin,\n  });\n};\n","import { analytics } from '../..';\nimport type { CLI_ORIGIN } from '../../analytics';\nimport { create } from '../create/create';\nimport type { Editor } from '../init/mcp-docs-server-install';\nimport type { Component, LLMProvider } from '../init/utils';\n\nconst origin = process.env.MASTRA_ANALYTICS_ORIGIN as CLI_ORIGIN;\n\ninterface CreateProjectArgs {\n  default?: boolean;\n  components?: Component[];\n  llm?: LLMProvider;\n  llmApiKey?: string;\n  example?: boolean;\n  timeout?: string | boolean;\n  dir?: string;\n  projectName?: string;\n  mcp?: Editor;\n  skills?: string[];\n  template?: string | boolean;\n}\n\nexport const createProject = async (projectNameArg: string | undefined, args: CreateProjectArgs) => {\n  const projectName = projectNameArg || args.projectName;\n  await analytics.trackCommandExecution({\n    command: 'create',\n    args: { ...args, projectName },\n    execution: async () => {\n      const timeout = args?.timeout ? (args?.timeout === true ? 60000 : parseInt(args?.timeout, 10)) : undefined;\n      if (args.default) {\n        await create({\n          components: ['agents', 'tools', 'workflows'],\n          llmProvider: 'openai',\n          addExample: true,\n          timeout,\n          mcpServer: args.mcp,\n          skills: args.skills,\n          template: args.template,\n        });\n        return;\n      }\n      await create({\n        components: args.components ? args.components : [],\n        llmProvider: args.llm,\n        addExample: args.example,\n        llmApiKey: args.llmApiKey,\n        timeout,\n        projectName,\n        directory: args.dir,\n        mcpServer: args.mcp,\n        skills: args.skills,\n        template: args.template,\n      });\n    },\n    origin,\n  });\n};\n","import { analytics } from '../..';\nimport type { CLI_ORIGIN } from '../../analytics';\nimport { init } from '../init/init';\nimport type { Editor } from '../init/mcp-docs-server-install';\nimport { checkAndInstallCoreDeps, checkForPkgJson, interactivePrompt } from '../init/utils';\nimport type { Component, LLMProvider } from '../init/utils';\nimport { getVersionTag, isGitInitialized } from '../utils';\n\nconst origin = process.env.MASTRA_ANALYTICS_ORIGIN as CLI_ORIGIN;\n\ninterface InitArgs {\n  default?: boolean;\n  dir?: string;\n  components?: Component[];\n  llm?: LLMProvider;\n  llmApiKey?: string;\n  example?: boolean;\n  mcp?: Editor;\n}\n\nexport const initProject = async (args: InitArgs) => {\n  await analytics.trackCommandExecution({\n    command: 'init',\n    args: { ...args },\n    execution: async () => {\n      await checkForPkgJson();\n\n      // Detect the version tag (e.g., 'beta', 'latest') from the running CLI\n      const versionTag = await getVersionTag();\n      const skipGitInit = await isGitInitialized({ cwd: process.cwd() });\n\n      await checkAndInstallCoreDeps(Boolean(args?.example || args?.default), versionTag);\n\n      if (!Object.keys(args).length) {\n        const result = await interactivePrompt({ skip: { gitInit: skipGitInit } });\n        await init({\n          ...result,\n          llmApiKey: result?.llmApiKey as string,\n          components: ['agents', 'tools', 'workflows'],\n          addExample: true,\n          skills: result?.skills,\n          mcpServer: result?.mcpServer,\n          versionTag,\n        });\n        return;\n      }\n\n      if (args?.default) {\n        await init({\n          directory: 'src/',\n          components: ['agents', 'tools', 'workflows'],\n          llmProvider: 'openai',\n          addExample: true,\n          mcpServer: args.mcp,\n          versionTag,\n        });\n        return;\n      }\n\n      await init({\n        directory: args.dir,\n        components: args.components ? args.components : [],\n        llmProvider: args.llm,\n        addExample: args.example,\n        llmApiKey: args.llmApiKey,\n        mcpServer: args.mcp,\n        versionTag,\n      });\n      return;\n    },\n    origin,\n  });\n};\n","import { logger } from '../../../utils/logger.js';\nimport type { LintContext, LintRule } from './types.js';\n\nexport const mastraCoreRule: LintRule = {\n  name: 'mastra-core',\n  description: 'Checks if @mastra/core is installed',\n  async run(context: LintContext): Promise<boolean> {\n    const hasCore = context.mastraPackages.some(pkg => pkg.name === '@mastra/core');\n    if (!hasCore) {\n      logger.error('@mastra/core is not installed. This package is required for Mastra to work properly.');\n      return false;\n    }\n    return true;\n  },\n};\n","import { readFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { logger } from '../../../utils/logger.js';\nimport type { LintContext, LintRule } from './types.js';\n\nfunction readNextConfig(dir: string) {\n  const nextConfigPath = join(dir, 'next.config.js');\n  try {\n    const nextConfigContent = readFileSync(nextConfigPath, 'utf-8');\n    const configMatch = nextConfigContent.match(/const nextConfig = ({[\\s\\S]*?});/);\n    if (!configMatch?.[1]) {\n      return null;\n    }\n    const configStr = configMatch[1].replace(/\\n/g, '').replace(/\\s+/g, ' ');\n    return eval(`(${configStr})`);\n  } catch {\n    return null;\n  }\n}\n\nfunction isNextJsProject(dir: string): boolean {\n  const nextConfigPath = join(dir, 'next.config.js');\n  try {\n    readFileSync(nextConfigPath, 'utf-8');\n    return true;\n  } catch {\n    return false;\n  }\n}\n// TODO: Move to babel\nexport const nextConfigRule: LintRule = {\n  name: 'next-config',\n  description: 'Checks if Next.js config is properly configured for Mastra packages',\n  async run(context: LintContext): Promise<boolean> {\n    if (!isNextJsProject(context.rootDir)) {\n      return true;\n    }\n\n    const nextConfig = readNextConfig(context.rootDir);\n    if (!nextConfig) {\n      return false;\n    }\n\n    const serverExternals = nextConfig.serverExternalPackages || [];\n    const hasMastraExternals = serverExternals.some(\n      (pkg: string) => pkg === '@mastra/*' || pkg === '@mastra/core' || pkg.startsWith('@mastra/'),\n    );\n\n    if (!hasMastraExternals) {\n      logger.error('next.config.js is missing Mastra packages in serverExternalPackages');\n      logger.error('Please add the following to your next.config.js:');\n      logger.error('  serverExternalPackages: [\"@mastra/*\"],');\n      return false;\n    }\n\n    logger.info('Next.js config is properly configured for Mastra packages');\n    return true;\n  },\n};\n","import { readFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport stripJsonComments from 'strip-json-comments';\nimport { logger } from '../../../utils/logger.js';\nimport type { LintContext, LintRule } from './types.js';\n\nfunction readTsConfig(dir: string) {\n  const tsConfigPath = join(dir, 'tsconfig.json');\n  try {\n    const tsConfigContent = readFileSync(tsConfigPath, 'utf-8');\n    const cleanTsConfigContent = stripJsonComments(tsConfigContent);\n    return JSON.parse(cleanTsConfigContent);\n  } catch {\n    return null;\n  }\n}\n\nexport const tsConfigRule: LintRule = {\n  name: 'ts-config',\n  description: 'Checks if TypeScript config is properly configured for Mastra packages',\n  async run(context: LintContext): Promise<boolean> {\n    const tsConfig = readTsConfig(context.rootDir);\n    if (!tsConfig) {\n      logger.warn('No tsconfig.json found. This might cause issues with Mastra packages.');\n      return true; // Not a critical error, just a warning\n    }\n\n    const { module, moduleResolution } = tsConfig.compilerOptions || {};\n\n    // Check if either moduleResolution is 'bundler' or module is 'CommonJS'\n    const isValidConfig = moduleResolution === 'bundler' || module === 'CommonJS';\n    if (!isValidConfig) {\n      logger.error('tsconfig.json has invalid configuration');\n      logger.error('Please set either:');\n      logger.error('  \"compilerOptions\": {');\n      logger.error('    \"moduleResolution\": \"bundler\"');\n      logger.error('  }');\n      logger.error('or');\n      logger.error('  \"compilerOptions\": {');\n      logger.error('    \"module\": \"CommonJS\"');\n      logger.error('  }');\n      logger.error('For the recommended TypeScript configuration, see:');\n      logger.error('https://mastra.ai/en/docs/getting-started/installation#initialize-typescript');\n      return false;\n    }\n\n    logger.info('TypeScript config is properly configured for Mastra packages');\n    return true;\n  },\n};\n","import { mastraCoreRule } from './mastraCoreRule.js';\nimport { nextConfigRule } from './nextConfigRule.js';\nimport { tsConfigRule } from './tsConfigRule.js';\nimport type { LintRule } from './types.js';\n\nexport const rules: LintRule[] = [nextConfigRule, tsConfigRule, mastraCoreRule];\n","import { readFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { getDeployer } from '@mastra/deployer';\nimport { FileService } from '../../services/service.file.js';\nimport { logger } from '../../utils/logger.js';\nimport { BuildBundler } from '../build/BuildBundler.js';\nimport { rules } from './rules/index.js';\nimport type { LintContext } from './rules/types.js';\n\ninterface PackageJson {\n  dependencies?: Record<string, string>;\n  devDependencies?: Record<string, string>;\n}\n\ninterface MastraPackage {\n  name: string;\n  version: string;\n  isAlpha: boolean;\n}\n\nfunction readPackageJson(dir: string): PackageJson {\n  const packageJsonPath = join(dir, 'package.json');\n  try {\n    const packageJsonContent = readFileSync(packageJsonPath, 'utf-8');\n    return JSON.parse(packageJsonContent);\n  } catch (error) {\n    if (error instanceof Error) {\n      logger.error(`Failed to read package.json: ${error.message}`);\n    }\n    throw error;\n  }\n}\n\nfunction getMastraPackages(packageJson: PackageJson): MastraPackage[] {\n  const allDependencies = {\n    ...packageJson.dependencies,\n    ...packageJson.devDependencies,\n  };\n\n  const mastraPackages = Object.entries(allDependencies).filter(\n    ([name]) => name.startsWith('@mastra/') || name === 'mastra',\n  );\n\n  return mastraPackages.map(([name, version]) => ({\n    name,\n    version,\n    isAlpha: version.includes('alpha'),\n  }));\n}\n\nexport async function lint({ dir, root, tools }: { dir?: string; root?: string; tools?: string[] }): Promise<boolean> {\n  try {\n    const rootDir = root || process.cwd();\n    const mastraDir = dir\n      ? dir.startsWith('/')\n        ? dir\n        : join(process.cwd(), dir)\n      : join(process.cwd(), 'src', 'mastra');\n    const outputDirectory = join(rootDir, '.mastra');\n\n    const defaultToolsPath = join(mastraDir, 'tools');\n    const discoveredTools = [defaultToolsPath, ...(tools ?? [])];\n\n    const packageJson = readPackageJson(rootDir);\n    const mastraPackages = getMastraPackages(packageJson);\n\n    const context: LintContext = {\n      rootDir,\n      mastraDir,\n      outputDirectory,\n      discoveredTools,\n      packageJson,\n      mastraPackages,\n    };\n\n    // Run all rules\n    const results = await Promise.all(rules.map(rule => rule.run(context)));\n    const allRulesPassed = results.every(result => result);\n\n    // Run deployer lint if all rules passed\n    if (allRulesPassed) {\n      const fileService = new FileService();\n      const mastraEntryFile = fileService.getFirstExistingFile([\n        join(mastraDir, 'index.ts'),\n        join(mastraDir, 'index.js'),\n      ]);\n      const platformDeployer = await getDeployer(mastraEntryFile, outputDirectory);\n      if (!platformDeployer) {\n        const deployer = new BuildBundler();\n        await deployer.lint(mastraEntryFile, outputDirectory, discoveredTools);\n      } else {\n        await platformDeployer.lint(mastraEntryFile, outputDirectory, discoveredTools);\n      }\n    }\n\n    return allRulesPassed;\n  } catch (error) {\n    if (error instanceof Error) {\n      logger.error(`Lint check failed: ${error.message}`);\n    }\n    return false;\n  }\n}\n","import { analytics, origin } from '../..';\nimport { lint } from '../lint';\n\nexport const lintProject = async (args: { dir?: string; root?: string; tools?: string }) => {\n  await analytics.trackCommandExecution({\n    command: 'lint',\n    args,\n    execution: async () => {\n      await lint({ dir: args.dir, root: args.root, tools: args.tools ? args.tools.split(',') : [] });\n    },\n    origin,\n  });\n};\n","import * as p from '@clack/prompts';\nimport color from 'picocolors';\nimport { AVAILABLE_SCORERS } from './available-scorers';\nimport type { ScorerTemplate } from './types';\n\nfunction formatCategoryName(category: string): string {\n  return category\n    .split('-')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n}\n\nfunction formatTable(scorers: ScorerTemplate[]): string {\n  if (scorers.length === 0) return '';\n\n  // Calculate column widths\n  const nameWidth = Math.max(4, Math.max(...scorers.map(s => s.name.length)));\n  const idWidth = Math.max(2, Math.max(...scorers.map(s => s.id.length)));\n  const typeWidth = Math.max(4, Math.max(...scorers.map(s => s.type.length)));\n  const descWidth = Math.max(11, Math.max(...scorers.map(s => s.description.length)));\n\n  // Create header\n  const header = `${color.bold('Name'.padEnd(nameWidth))}  ${color.bold('ID'.padEnd(idWidth))}  ${color.bold('Type'.padEnd(typeWidth))}  ${color.bold('Description'.padEnd(descWidth))}`;\n  const separator =\n    ''.repeat(nameWidth) +\n    '' +\n    ''.repeat(idWidth) +\n    '' +\n    ''.repeat(typeWidth) +\n    '' +\n    ''.repeat(descWidth) +\n    '';\n\n  // Create rows\n  const rows = scorers.map(\n    scorer =>\n      `${(scorer?.name ?? scorer?.id).padEnd(nameWidth)}  ${color.dim(scorer.id.padEnd(idWidth))}  ${scorer.type.padEnd(typeWidth)}  ${color.dim(scorer.description.padEnd(descWidth))}`,\n  );\n\n  return [header, separator, ...rows].join('\\n');\n}\n\nexport function listAllScorers(): void {\n  p.intro(color.inverse(' Available Scorers '));\n\n  const groupedScorers = AVAILABLE_SCORERS.reduce(\n    (acc, scorer) => {\n      if (!acc[scorer.category]) {\n        acc[scorer.category] = [];\n      }\n      acc[scorer.category]!.push(scorer);\n      return acc;\n    },\n    {} as Record<string, ScorerTemplate[]>,\n  );\n\n  for (const [category, scorers] of Object.entries(groupedScorers)) {\n    p.log.info(`${color.bold(color.cyan(formatCategoryName(category)))} Scorers:`);\n    p.log.message(formatTable(scorers));\n  }\n}\n","import { analytics } from '../..';\nimport type { CLI_ORIGIN } from '../../analytics';\nimport { listAllScorers } from '../scorers/list-all-scorers';\n\nconst origin = process.env.MASTRA_ANALYTICS_ORIGIN as CLI_ORIGIN;\n\nexport const listScorers = async (args: {}) => {\n  await analytics.trackCommandExecution({\n    command: 'scorers-list',\n    args,\n    execution: async () => {\n      return listAllScorers();\n    },\n    origin,\n  });\n};\n","import { FileService } from '@mastra/deployer/build';\n\nimport { BuildBundler } from '../build/BuildBundler.js';\nimport { shouldSkipDotenvLoading } from '../utils.js';\n\nexport class MigrateBundler extends BuildBundler {\n  private customEnvFile?: string;\n\n  constructor(customEnvFile?: string) {\n    super({ studio: false });\n    this.customEnvFile = customEnvFile;\n  }\n\n  override getEnvFiles(): Promise<string[]> {\n    // Skip loading .env files if MASTRA_SKIP_DOTENV is set\n    if (shouldSkipDotenvLoading()) {\n      return Promise.resolve([]);\n    }\n\n    const possibleFiles = ['.env.development', '.env.local', '.env'];\n    if (this.customEnvFile) {\n      possibleFiles.unshift(this.customEnvFile);\n    }\n\n    try {\n      const fileService = new FileService();\n      const envFile = fileService.getFirstExistingFile(possibleFiles);\n\n      return Promise.resolve([envFile]);\n    } catch {\n      // ignore\n    }\n\n    return Promise.resolve([]);\n  }\n\n  async bundle(\n    entryFile: string,\n    outputDirectory: string,\n    { toolsPaths, projectRoot }: { toolsPaths: (string | string[])[]; projectRoot: string },\n  ): Promise<void> {\n    return this._bundle(this.getEntry(), entryFile, { outputDirectory, projectRoot }, toolsPaths);\n  }\n\n  protected override getEntry(): string {\n    return `\n    import { mastra } from '#mastra';\n\n    async function runMigration() {\n      const storage = mastra.getStorage();\n\n      if (!storage) {\n        console.log(JSON.stringify({\n          success: false,\n          alreadyMigrated: false,\n          duplicatesRemoved: 0,\n          message: 'Storage not configured. Please configure storage in your Mastra instance.',\n        }));\n        process.exit(1);\n      }\n\n      // Access the observability store directly from storage.stores\n      const observabilityStore = storage.stores?.observability;\n\n      if (!observabilityStore) {\n        console.log(JSON.stringify({\n          success: false,\n          alreadyMigrated: false,\n          duplicatesRemoved: 0,\n          message: 'Observability storage not configured. Migration not required.',\n        }));\n        process.exit(0);\n      }\n\n      // Check if the store has a migrateSpans method\n      if (typeof observabilityStore.migrateSpans !== 'function') {\n        console.log(JSON.stringify({\n          success: false,\n          alreadyMigrated: false,\n          duplicatesRemoved: 0,\n          message: 'Migration not supported for this storage backend.',\n        }));\n        process.exit(1);\n      }\n\n      try {\n        // Run the migration - migrateSpans handles everything internally\n        const result = await observabilityStore.migrateSpans();\n\n        console.log(JSON.stringify({\n          success: result.success,\n          alreadyMigrated: result.alreadyMigrated,\n          duplicatesRemoved: result.duplicatesRemoved,\n          message: result.message,\n        }));\n\n        process.exit(result.success ? 0 : 1);\n      } catch (error) {\n        console.log(JSON.stringify({\n          success: false,\n          alreadyMigrated: false,\n          duplicatesRemoved: 0,\n          message: error instanceof Error ? error.message : 'Unknown error during migration',\n        }));\n        process.exit(1);\n      }\n    }\n\n    runMigration();\n    `;\n  }\n}\n","import { join } from 'node:path';\nimport process from 'node:process';\nimport * as p from '@clack/prompts';\nimport { FileService } from '@mastra/deployer';\nimport { execa } from 'execa';\nimport pc from 'picocolors';\n\nimport { createLogger } from '../../utils/logger.js';\n\nimport { MigrateBundler } from './MigrateBundler';\n\ninterface MigrationResult {\n  success: boolean;\n  alreadyMigrated: boolean;\n  duplicatesRemoved: number;\n  message: string;\n}\n\nexport async function migrate({\n  dir,\n  root,\n  env,\n  debug,\n  yes,\n}: {\n  dir?: string;\n  root?: string;\n  env?: string;\n  debug: boolean;\n  yes: boolean;\n}) {\n  const logger = createLogger(debug);\n  const rootDir = root || process.cwd();\n  const mastraDir = dir ? (dir.startsWith('/') ? dir : join(process.cwd(), dir)) : join(process.cwd(), 'src', 'mastra');\n  const dotMastraPath = join(rootDir, '.mastra');\n\n  p.intro(pc.cyan('Mastra Storage Migration'));\n\n  // Show backup warning and ask for confirmation (unless --yes flag is used)\n  if (!yes) {\n    p.log.warn(pc.yellow('Warning: This migration will modify your database.'));\n    p.log.message('Before proceeding, please ensure you have:');\n    p.log.message('   Created a backup of your database');\n    p.log.message('   Tested this migration in a non-production environment');\n\n    const confirmed = await p.confirm({\n      message: 'Have you backed up your database and are ready to proceed?',\n      initialValue: false,\n    });\n\n    if (p.isCancel(confirmed) || !confirmed) {\n      p.log.info('Migration cancelled. Please back up your database before running this command.');\n      p.log.message(pc.dim('Tip: Use --yes or -y to skip this prompt in CI/automation.'));\n      process.exit(0);\n    }\n  }\n\n  try {\n    const fileService = new FileService();\n    const entryFile = fileService.getFirstExistingFile([join(mastraDir, 'index.ts'), join(mastraDir, 'index.js')]);\n\n    const bundler = new MigrateBundler(env);\n    bundler.__setLogger(logger);\n\n    logger.info('Building project for migration...');\n\n    // Prepare the output directory\n    await bundler.prepare(dotMastraPath);\n\n    // Bundle the project with migration entry\n    const discoveredTools = bundler.getAllToolPaths(mastraDir, []);\n    await bundler.bundle(entryFile, dotMastraPath, {\n      toolsPaths: discoveredTools,\n      projectRoot: rootDir,\n    });\n\n    logger.info('Running migration...');\n    logger.info(pc.dim('This may take a while for large tables.'));\n    logger.info('');\n\n    // Load environment variables\n    const loadedEnv = await bundler.loadEnvVars();\n\n    // Execute the bundled migration script\n    const migrationProcess = execa(process.execPath, [join(dotMastraPath, 'output', 'index.mjs')], {\n      cwd: rootDir,\n      env: {\n        NODE_ENV: 'production',\n        MASTRA_DISABLE_STORAGE_INIT: 'true', // Prevent MIGRATION_REQUIRED error during import\n        ...Object.fromEntries(loadedEnv),\n      },\n      stdio: ['inherit', 'pipe', 'pipe'],\n      reject: false,\n    });\n\n    let stdoutData = '';\n    let stderrData = '';\n\n    migrationProcess.stdout?.on('data', (data: Buffer) => {\n      stdoutData += data.toString();\n    });\n\n    migrationProcess.stderr?.on('data', (data: Buffer) => {\n      stderrData += data.toString();\n      // Print stderr to console for debugging\n      if (debug) {\n        process.stderr.write(data);\n      }\n    });\n\n    const processResult = await migrationProcess;\n\n    // Try to parse the JSON result from stdout\n    let result: MigrationResult | undefined;\n    try {\n      // Find the last JSON object in the output (in case there's other output)\n      const jsonMatch = stdoutData.match(/\\{[^{}]*\"success\"[^{}]*\\}/g);\n      if (jsonMatch && jsonMatch.length > 0) {\n        result = JSON.parse(jsonMatch[jsonMatch.length - 1]!);\n      }\n    } catch {\n      // If we can't parse JSON, the migration likely failed\n    }\n\n    if (result) {\n      if (result.success) {\n        if (result.alreadyMigrated) {\n          logger.info(pc.green(' Migration already complete.'));\n        } else {\n          logger.info(pc.green(' Migration completed successfully!'));\n          if (result.duplicatesRemoved > 0) {\n            logger.info(`  Removed ${result.duplicatesRemoved} duplicate entries.`);\n          }\n        }\n        logger.info(`  ${result.message}`);\n      } else {\n        logger.error(pc.red(' Migration failed.'));\n        logger.error(`  ${result.message}`);\n        process.exit(1);\n      }\n    } else {\n      // No JSON result - check if process failed\n      if (processResult.exitCode !== 0) {\n        logger.error(pc.red(' Migration failed.'));\n        if (stderrData) {\n          logger.error(stderrData);\n        }\n        if (stdoutData && !stdoutData.includes('\"success\"')) {\n          logger.error(stdoutData);\n        }\n        process.exit(1);\n      } else {\n        // Process succeeded but no JSON output - unusual but OK\n        logger.info(pc.green(' Migration completed.'));\n      }\n    }\n  } catch (error: any) {\n    if (error.code === 'ERR_MODULE_NOT_FOUND' || error.message?.includes('Cannot find module')) {\n      logger.error(pc.red('Error: Could not find Mastra entry file.'));\n      logger.info('');\n      logger.info('Make sure you have a mastra directory with an index.ts or index.js file.');\n      logger.info(`Expected location: ${mastraDir}`);\n      logger.info('');\n      logger.info('You can specify a custom directory:');\n      logger.info(pc.cyan('  npx mastra migrate --dir path/to/mastra'));\n    } else {\n      logger.error(pc.red(`Error: ${error.message}`));\n      if (debug) {\n        logger.error(error);\n      }\n    }\n    process.exit(1);\n  }\n}\n","import { analytics, origin } from '../..';\nimport { migrate as runMigrate } from '../migrate/migrate';\n\nexport const migrate = async (args: { dir?: string; root?: string; env?: string; debug?: boolean; yes?: boolean }) => {\n  await analytics.trackCommandExecution({\n    command: 'mastra migrate',\n    args: { ...args },\n    execution: async () => {\n      await runMigrate({\n        dir: args?.dir,\n        root: args?.root,\n        env: args?.env,\n        debug: args?.debug ?? false,\n        yes: args?.yes ?? false,\n      });\n    },\n    origin,\n  });\n};\n","import path from 'node:path';\nimport pc from 'picocolors';\nimport { version } from '..';\ninterface DevLoggerOptions {\n  timestamp?: boolean;\n  colors?: boolean;\n}\n\ninterface HTTPSOptions {\n  key: Buffer;\n  cert: Buffer;\n}\n\nexport class DevLogger {\n  private options: DevLoggerOptions;\n\n  constructor(options: DevLoggerOptions = {}) {\n    this.options = {\n      timestamp: false,\n      colors: true,\n      ...options,\n    };\n  }\n\n  private formatTime(): string {\n    if (!this.options.timestamp) return '';\n    return pc.dim(new Date().toLocaleTimeString());\n  }\n\n  private formatPrefix(text: string, color: (str: string) => string): string {\n    const time = this.formatTime();\n    const prefix = pc.bold(color(text));\n    return time ? `${time} ${prefix}` : prefix;\n  }\n\n  info(message: string): void {\n    const prefix = this.formatPrefix('', pc.cyan);\n    console.info(`${prefix} ${message}`);\n  }\n\n  success(message: string): void {\n    const prefix = this.formatPrefix('', pc.green);\n    console.info(`${prefix} ${pc.green(message)}`);\n  }\n\n  warn(message: string): void {\n    const prefix = this.formatPrefix('', pc.yellow);\n    console.info(`${prefix} ${pc.yellow(message)}`);\n  }\n\n  error(message: string): void {\n    const prefix = this.formatPrefix('', pc.red);\n    console.info(`${prefix} ${pc.red(message)}`);\n  }\n\n  starting(): void {\n    const prefix = this.formatPrefix('', pc.blue);\n    console.info(`${prefix} ${pc.blue('Starting Mastra dev server...')}`);\n  }\n\n  ready(host: string, port: number, studioBasePath: string, startTime?: number, https?: HTTPSOptions): void {\n    let protocol = 'http';\n    if (https && https.key && https.cert) {\n      protocol = 'https';\n    }\n\n    console.info('');\n    const timing = startTime ? `${Date.now() - startTime} ms` : 'XXX ms';\n    console.info(pc.inverse(pc.green(' mastra ')) + ` ${pc.green(version)} ${pc.gray('ready in')} ${timing}`);\n    console.info('');\n    console.info(`${pc.dim('')} ${pc.bold('Studio:')} ${pc.cyan(`${protocol}://${host}:${port}${studioBasePath}`)}`);\n    console.info(`${pc.dim('')} ${pc.bold('API:')}    ${`${protocol}://${host}:${port}/api`}`);\n    console.info('');\n  }\n\n  bundling(): void {\n    const prefix = this.formatPrefix('', pc.magenta);\n    console.info(`${prefix} ${pc.magenta('Bundling...')}`);\n  }\n\n  bundleComplete(): void {\n    const prefix = this.formatPrefix('', pc.green);\n    console.info(`${prefix} ${pc.green('Bundle complete')}`);\n  }\n\n  watching(): void {\n    const time = this.formatTime();\n    const icon = pc.dim('');\n    const message = pc.dim('watching for file changes...');\n    const fullMessage = `${icon} ${message}`;\n    console.info(time ? `${time} ${fullMessage}` : fullMessage);\n  }\n\n  restarting(): void {\n    const prefix = this.formatPrefix('', pc.blue);\n    console.info(`${prefix} ${pc.blue('Restarting server...')}`);\n  }\n\n  fileChange(file: string): void {\n    const prefix = this.formatPrefix('', pc.cyan);\n    const fileName = path.basename(file);\n    console.info(`${prefix} ${pc.cyan('File changed:')} ${pc.dim(fileName)}`);\n  }\n\n  // Enhanced error reporting\n  serverError(error: string): void {\n    console.info('');\n    console.info(pc.red('   ') + pc.bold(pc.red('Server Error')));\n    console.info('');\n    console.info(`  ${pc.red('')} ${error}`);\n    console.info('');\n  }\n\n  shutdown(): void {\n    console.info('');\n    const prefix = this.formatPrefix('', pc.green);\n    console.info(`${prefix} ${pc.green('Dev server stopped')}`);\n  }\n\n  envInfo(info: { port: number; env?: string; root: string }): void {\n    console.info('');\n    console.info(`  ${pc.dim('')} ${pc.bold('Environment:')} ${pc.cyan(info.env || 'development')}`);\n    console.info(`  ${pc.dim('')} ${pc.bold('Root:')} ${pc.dim(info.root)}`);\n    console.info(`  ${pc.dim('')} ${pc.bold('Port:')} ${pc.cyan(info.port.toString())}`);\n  }\n\n  raw(message: string): void {\n    console.info(message);\n  }\n\n  debug(message: string): void {\n    if (process.env.DEBUG || process.env.MASTRA_DEBUG) {\n      const prefix = this.formatPrefix('', pc.gray);\n      console.info(`${prefix} ${pc.gray(message)}`);\n    }\n  }\n\n  private spinnerChars = ['', '', '', ''];\n  private spinnerIndex = 0;\n\n  getSpinnerChar(): string {\n    const char = this.spinnerChars[this.spinnerIndex];\n    this.spinnerIndex = (this.spinnerIndex + 1) % this.spinnerChars.length;\n    return char || ''; // fallback to default char\n  }\n\n  clearLine(): void {\n    process.stdout.write('\\r\\x1b[K');\n  }\n\n  update(message: string): void {\n    this.clearLine();\n    const prefix = this.formatPrefix(this.getSpinnerChar(), pc.cyan);\n    process.stdout.write(`${prefix} ${message}`);\n  }\n}\n\nexport const devLogger = new DevLogger();\n","import { existsSync } from 'node:fs';\nimport { readFile } from 'node:fs/promises';\nimport { resolve } from 'node:path';\n\n/**\n * Loads and validates a request context presets JSON file.\n *\n * @param presetsPath - Path to the presets JSON file (relative or absolute)\n * @returns The original JSON string content\n * @throws Error if file doesn't exist, JSON is invalid, or structure is incorrect\n */\nexport async function loadAndValidatePresets(presetsPath: string): Promise<string> {\n  const absolutePath = resolve(process.cwd(), presetsPath);\n\n  if (!existsSync(absolutePath)) {\n    throw new Error(`Presets file not found: ${absolutePath}`);\n  }\n\n  const content = await readFile(absolutePath, 'utf-8');\n\n  let parsed: unknown;\n  try {\n    parsed = JSON.parse(content);\n  } catch {\n    throw new Error(`Invalid JSON in presets file: ${presetsPath}`);\n  }\n\n  if (typeof parsed !== 'object' || parsed === null || Array.isArray(parsed)) {\n    throw new Error(`Presets file must contain a JSON object with named presets`);\n  }\n\n  // Validate each preset value is an object\n  for (const [key, value] of Object.entries(parsed)) {\n    if (typeof value !== 'object' || value === null || Array.isArray(value)) {\n      throw new Error(`Preset \"${key}\" must be a JSON object`);\n    }\n  }\n\n  return content; // Return original string to preserve formatting\n}\n\n/**\n * Escapes a JSON string for safe embedding in HTML/JavaScript.\n * Handles backslashes, single quotes, newlines, carriage returns,\n * script-breaking sequences, and Unicode line terminators.\n *\n * @param json - JSON string to escape\n * @returns Escaped string safe for HTML embedding\n */\nexport function escapeJsonForHtml(json: string): string {\n  return json\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/'/g, \"\\\\'\")\n    .replace(/\\n/g, '\\\\n')\n    .replace(/\\r/g, '\\\\r')\n    .replace(/</g, '\\\\u003c')\n    .replace(/>/g, '\\\\u003e')\n    .replace(/\\u2028/g, '\\\\u2028')\n    .replace(/\\u2029/g, '\\\\u2029');\n}\n","import { writeFile } from 'node:fs/promises';\nimport { dirname, join } from 'node:path';\nimport { fileURLToPath } from 'node:url';\nimport { FileService } from '@mastra/deployer';\nimport { createWatcher, getWatcherInputOptions } from '@mastra/deployer/build';\nimport { Bundler } from '@mastra/deployer/bundler';\nimport * as fsExtra from 'fs-extra';\nimport type { InputPluginOption, RollupWatcherEvent } from 'rollup';\n\nimport { devLogger } from '../../utils/dev-logger.js';\nimport { shouldSkipDotenvLoading } from '../utils.js';\n\nexport class DevBundler extends Bundler {\n  private customEnvFile?: string;\n\n  constructor(customEnvFile?: string) {\n    super('Dev');\n    this.customEnvFile = customEnvFile;\n    // Use 'neutral' platform for Bun to preserve Bun-specific globals, 'node' otherwise\n    this.platform = process.versions?.bun ? 'neutral' : 'node';\n  }\n\n  getEnvFiles(): Promise<string[]> {\n    // Skip loading .env files if MASTRA_SKIP_DOTENV is set\n    if (shouldSkipDotenvLoading()) {\n      return Promise.resolve([]);\n    }\n\n    const possibleFiles = ['.env.development', '.env.local', '.env'];\n    if (this.customEnvFile) {\n      possibleFiles.unshift(this.customEnvFile);\n    }\n\n    try {\n      const fileService = new FileService();\n      const envFile = fileService.getFirstExistingFile(possibleFiles);\n\n      return Promise.resolve([envFile]);\n    } catch {\n      // ignore\n    }\n\n    return Promise.resolve([]);\n  }\n\n  async prepare(outputDirectory: string): Promise<void> {\n    await super.prepare(outputDirectory);\n\n    const __filename = fileURLToPath(import.meta.url);\n    const __dirname = dirname(__filename);\n\n    const studioServePath = join(outputDirectory, this.outputDir, 'studio');\n    await fsExtra.copy(join(dirname(__dirname), join('dist', 'studio')), studioServePath, {\n      overwrite: true,\n    });\n  }\n\n  async watch(\n    entryFile: string,\n    outputDirectory: string,\n    toolsPaths: (string | string[])[],\n  ): ReturnType<typeof createWatcher> {\n    const __filename = fileURLToPath(import.meta.url);\n    const __dirname = dirname(__filename);\n\n    const envFiles = await this.getEnvFiles();\n    const bundlerOptions = await this.getUserBundlerOptions(entryFile, outputDirectory);\n    const sourcemapEnabled = !!bundlerOptions?.sourcemap;\n\n    const inputOptions = await getWatcherInputOptions(\n      entryFile,\n      this.platform,\n      {\n        'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV || 'development'),\n      },\n      { sourcemap: sourcemapEnabled },\n    );\n    const toolsInputOptions = await this.listToolsInputOptions(toolsPaths);\n\n    const outputDir = join(outputDirectory, this.outputDir);\n\n    await this.writePackageJson(outputDir, new Map(), {});\n\n    const watcher = await createWatcher(\n      {\n        ...inputOptions,\n        logLevel: inputOptions.logLevel === 'silent' ? 'warn' : inputOptions.logLevel,\n        onwarn: warning => {\n          if (warning.code === 'CIRCULAR_DEPENDENCY') {\n            if (warning.ids?.[0]?.includes('node_modules')) {\n              return;\n            }\n\n            this.logger.warn(`Circular dependency found:\n\\t${warning.message.replace('Circular dependency: ', '')}`);\n          }\n        },\n        plugins: [\n          ...(inputOptions.plugins as InputPluginOption[]),\n          {\n            name: 'env-watcher',\n            buildStart() {\n              for (const envFile of envFiles) {\n                this.addWatchFile(envFile);\n              }\n            },\n          },\n          {\n            name: 'tools-watcher',\n            async buildEnd() {\n              const toolImports: string[] = [];\n              const toolsExports: string[] = [];\n              Array.from(Object.keys(toolsInputOptions || {}))\n                .filter(key => key.startsWith('tools/'))\n                .forEach((key, index) => {\n                  const toolExport = `tool${index}`;\n                  toolImports.push(`import * as ${toolExport} from './${key}.mjs';`);\n                  toolsExports.push(toolExport);\n                });\n\n              await writeFile(\n                join(outputDir, 'tools.mjs'),\n                `${toolImports.join('\\n')}\n\n                export const tools = [${toolsExports.join(', ')}]`,\n              );\n            },\n          },\n        ],\n        input: {\n          index: join(__dirname, 'templates', 'dev.entry.js'),\n          ...toolsInputOptions,\n        },\n      },\n      {\n        dir: outputDir,\n        sourcemap: sourcemapEnabled,\n      },\n    );\n\n    devLogger.info('Preparing development environment...');\n    return new Promise((resolve, reject) => {\n      const cb = (event: RollupWatcherEvent) => {\n        if (event.code === 'BUNDLE_END') {\n          devLogger.success('Initial bundle complete');\n          watcher.off('event', cb);\n          resolve(watcher);\n        }\n\n        if (event.code === 'ERROR') {\n          console.info(event);\n          devLogger.error('Bundling failed - check console for details');\n          watcher.off('event', cb);\n          reject(event);\n        }\n      };\n\n      watcher.on('event', cb);\n    });\n  }\n\n  async bundle(): Promise<void> {\n    // Do nothing\n  }\n}\n","import type { ChildProcess } from 'node:child_process';\nimport { mkdir, writeFile } from 'node:fs/promises';\nimport { join } from 'node:path';\nimport process from 'node:process';\nimport devcert from '@expo/devcert';\nimport { FileService } from '@mastra/deployer';\nimport { getServerOptions, normalizeStudioBase } from '@mastra/deployer/build';\nimport { execa } from 'execa';\nimport getPort from 'get-port';\nimport pc from 'picocolors';\nimport { checkMastraPeerDeps, getUpdateCommand, logPeerDepWarnings } from '../../utils/check-peer-deps.js';\nimport type { PeerDepMismatch } from '../../utils/check-peer-deps.js';\nimport { devLogger } from '../../utils/dev-logger.js';\nimport { createLogger } from '../../utils/logger.js';\nimport type { MastraPackageInfo } from '../../utils/mastra-packages.js';\nimport { getMastraPackages } from '../../utils/mastra-packages.js';\nimport { loadAndValidatePresets } from '../../utils/validate-presets.js';\n\nimport { DevBundler } from './DevBundler';\n\nlet currentServerProcess: ChildProcess | undefined;\nlet isRestarting = false;\nlet serverStartTime: number | undefined;\nlet requestContextPresetsJson: string | undefined;\nconst ON_ERROR_MAX_RESTARTS = 3;\n\ninterface HTTPSOptions {\n  key: Buffer;\n  cert: Buffer;\n}\n\ninterface StartOptions {\n  inspect?: string | boolean;\n  inspectBrk?: string | boolean;\n  customArgs?: string[];\n  https?: HTTPSOptions;\n  mastraPackages?: MastraPackageInfo[];\n  peerDepMismatches?: PeerDepMismatch[];\n}\n\ntype ProcessOptions = {\n  port: number;\n  host: string;\n  studioBasePath: string;\n  publicDir: string;\n};\n\nconst restartAllActiveWorkflowRuns = async ({ host, port }: { host: string; port: number }) => {\n  try {\n    await fetch(`http://${host}:${port}/__restart-active-workflow-runs`, {\n      method: 'POST',\n    });\n  } catch (error) {\n    devLogger.error(`Failed to restart all active workflow runs: ${error}`);\n    // Retry after another second\n    await new Promise(resolve => setTimeout(resolve, 1500));\n    try {\n      await fetch(`http://${host}:${port}/__restart-active-workflow-runs`, {\n        method: 'POST',\n      });\n    } catch {\n      // Ignore retry errors\n    }\n  }\n};\n\nconst startServer = async (\n  dotMastraPath: string,\n  { port, host, studioBasePath, publicDir }: ProcessOptions,\n  env: Map<string, string>,\n  startOptions: StartOptions = {},\n  errorRestartCount = 0,\n) => {\n  let serverIsReady = false;\n  try {\n    // Restart server\n    serverStartTime = Date.now();\n    devLogger.starting();\n\n    const commands = [];\n\n    const inspect = startOptions.inspect === '' ? true : startOptions.inspect;\n    const inspectBrk = startOptions.inspectBrk === '' ? true : startOptions.inspectBrk;\n\n    if (inspect) {\n      const inspectFlag = typeof inspect === 'string' ? `--inspect=${inspect}` : '--inspect';\n      commands.push(inspectFlag);\n    }\n\n    if (inspectBrk) {\n      const inspectBrkFlag = typeof inspectBrk === 'string' ? `--inspect-brk=${inspectBrk}` : '--inspect-brk';\n      commands.push(inspectBrkFlag);\n    }\n\n    if (startOptions.customArgs) {\n      commands.push(...startOptions.customArgs);\n    }\n\n    commands.push(join(dotMastraPath, 'index.mjs'));\n\n    // Write mastra packages to a file and pass the file path via env var\n    const packagesFilePath = join(dotMastraPath, '..', 'mastra-packages.json');\n    await mkdir(dotMastraPath, { recursive: true });\n    if (startOptions.mastraPackages) {\n      await writeFile(packagesFilePath, JSON.stringify(startOptions.mastraPackages), 'utf-8');\n    }\n\n    await mkdir(publicDir, { recursive: true });\n    currentServerProcess = execa(process.execPath, commands, {\n      cwd: publicDir,\n      env: {\n        NODE_ENV: 'production',\n        ...Object.fromEntries(env),\n        MASTRA_DEV: 'true',\n        PORT: port.toString(),\n        MASTRA_PACKAGES_FILE: packagesFilePath,\n        ...(startOptions?.https\n          ? {\n              MASTRA_HTTPS_KEY: startOptions.https.key.toString('base64'),\n              MASTRA_HTTPS_CERT: startOptions.https.cert.toString('base64'),\n            }\n          : {}),\n      },\n      stdio: ['inherit', 'pipe', 'pipe', 'ipc'],\n      reject: false,\n    }) as any as ChildProcess;\n\n    if (currentServerProcess?.exitCode && currentServerProcess?.exitCode !== 0) {\n      if (!currentServerProcess) {\n        throw new Error(`Server failed to start`);\n      }\n      throw new Error(\n        `Server failed to start with error: ${currentServerProcess.stderr || currentServerProcess.stdout}`,\n      );\n    }\n\n    // Filter server output to remove Studio message\n    if (currentServerProcess.stdout) {\n      currentServerProcess.stdout.on('data', (data: Buffer) => {\n        const output = data.toString();\n        if (\n          !output.includes('Studio available') &&\n          !output.includes('') &&\n          !output.includes('Mastra API running on ')\n        ) {\n          process.stdout.write(output);\n        }\n      });\n    }\n\n    if (currentServerProcess.stderr) {\n      currentServerProcess.stderr.on('data', (data: Buffer) => {\n        const output = data.toString();\n        if (\n          !output.includes('Studio available') &&\n          !output.includes('') &&\n          !output.includes('Mastra API running on ')\n        ) {\n          process.stderr.write(output);\n        }\n      });\n    }\n\n    // Handle IPC errors to prevent EPIPE crashes\n    currentServerProcess.on('error', (err: Error) => {\n      if ((err as any).code !== 'EPIPE') {\n        throw err;\n      }\n    });\n\n    // Show hint about updating packages when server exits with error\n    currentServerProcess.on('exit', (code: number | null) => {\n      if (code !== null && code !== 0) {\n        const updateCommand = getUpdateCommand(startOptions.peerDepMismatches ?? []);\n        if (updateCommand) {\n          console.warn();\n          devLogger.warn(`This error may be caused by mismatched package versions. Try running:`);\n          console.warn(`  ${pc.cyan(updateCommand)}`);\n          console.warn();\n        }\n      }\n    });\n\n    currentServerProcess.on('message', async (message: any) => {\n      if (message?.type === 'server-ready') {\n        serverIsReady = true;\n        devLogger.ready(host, port, studioBasePath, serverStartTime, startOptions.https);\n        devLogger.watching();\n\n        await restartAllActiveWorkflowRuns({ host, port });\n\n        // Send refresh signal\n        try {\n          await fetch(`http://${host}:${port}${studioBasePath}/__refresh`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n          });\n        } catch {\n          // Retry after another second\n          await new Promise(resolve => setTimeout(resolve, 1500));\n          try {\n            await fetch(`http://${host}:${port}${studioBasePath}/__refresh`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n            });\n          } catch {\n            // Ignore retry errors\n          }\n        }\n      }\n    });\n  } catch (err) {\n    const execaError = err as { stderr?: string; stdout?: string };\n    if (execaError.stderr) {\n      devLogger.serverError(execaError.stderr);\n      devLogger.debug(`Server error output: ${execaError.stderr}`);\n    }\n    if (execaError.stdout) devLogger.debug(`Server output: ${execaError.stdout}`);\n\n    // Show hint about updating packages if there are peer dep mismatches\n    const updateCommand = getUpdateCommand(startOptions.peerDepMismatches ?? []);\n    if (updateCommand) {\n      devLogger.warn(`This error may be caused by mismatched package versions. Try running: ${updateCommand}`);\n    }\n\n    if (!serverIsReady) {\n      throw err;\n    }\n\n    // Attempt to restart on error after a delay\n    setTimeout(() => {\n      if (!isRestarting) {\n        errorRestartCount++;\n        if (errorRestartCount > ON_ERROR_MAX_RESTARTS) {\n          devLogger.error(`Server failed to start after ${ON_ERROR_MAX_RESTARTS} error attempts. Giving up.`);\n          process.exit(1);\n        }\n        devLogger.warn(\n          `Attempting to restart server after error... (Attempt ${errorRestartCount}/${ON_ERROR_MAX_RESTARTS})`,\n        );\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        startServer(\n          dotMastraPath,\n          {\n            port,\n            host,\n            studioBasePath,\n            publicDir,\n          },\n          env,\n          startOptions,\n          errorRestartCount,\n        );\n      }\n    }, 1000);\n  }\n};\n\nasync function checkAndRestart(\n  dotMastraPath: string,\n  { port, host, studioBasePath, publicDir }: ProcessOptions,\n  bundler: DevBundler,\n  startOptions: StartOptions = {},\n) {\n  if (isRestarting) {\n    return;\n  }\n\n  try {\n    // Check if hot reload is disabled due to template installation\n    const response = await fetch(`http://${host}:${port}${studioBasePath}/__hot-reload-status`);\n    if (response.ok) {\n      const status = (await response.json()) as { disabled: boolean; timestamp: string };\n      if (status.disabled) {\n        devLogger.info('[Mastra Dev] -   Server restart skipped: agent builder action in progress');\n        return;\n      }\n    }\n  } catch (error) {\n    // If we can't check status (server down), proceed with restart\n    devLogger.debug(`[Mastra Dev] - Could not check hot reload status: ${error}`);\n  }\n\n  // Proceed with restart\n  devLogger.info('[Mastra Dev] -  Restarting server...');\n  await rebundleAndRestart(dotMastraPath, { port, host, studioBasePath, publicDir }, bundler, startOptions);\n}\n\nasync function rebundleAndRestart(\n  dotMastraPath: string,\n  { port, host, studioBasePath, publicDir }: ProcessOptions,\n  bundler: DevBundler,\n  startOptions: StartOptions = {},\n) {\n  if (isRestarting) {\n    return;\n  }\n\n  isRestarting = true;\n  try {\n    // If current server process is running, stop it\n    if (currentServerProcess) {\n      devLogger.restarting();\n      devLogger.debug('Stopping current server...');\n      currentServerProcess.kill('SIGINT');\n    }\n\n    const env = await bundler.loadEnvVars();\n\n    // Add request context presets to env if available\n    if (requestContextPresetsJson) {\n      env.set('MASTRA_REQUEST_CONTEXT_PRESETS', requestContextPresetsJson);\n    }\n\n    // spread env into process.env\n    for (const [key, value] of env.entries()) {\n      process.env[key] = value;\n    }\n\n    await startServer(\n      join(dotMastraPath, 'output'),\n      {\n        port,\n        host,\n        studioBasePath,\n        publicDir,\n      },\n      env,\n      startOptions,\n    );\n  } finally {\n    isRestarting = false;\n  }\n}\n\nexport async function dev({\n  dir,\n  root,\n  tools,\n  env,\n  inspect,\n  inspectBrk,\n  customArgs,\n  https,\n  requestContextPresets,\n  debug,\n}: {\n  dir?: string;\n  root?: string;\n  tools?: string[];\n  env?: string;\n  inspect?: string | boolean;\n  inspectBrk?: string | boolean;\n  customArgs?: string[];\n  https?: boolean;\n  requestContextPresets?: string;\n  debug: boolean;\n}) {\n  const rootDir = root || process.cwd();\n  const mastraDir = dir ? (dir.startsWith('/') ? dir : join(process.cwd(), dir)) : join(process.cwd(), 'src', 'mastra');\n  const dotMastraPath = join(rootDir, '.mastra');\n\n  const fileService = new FileService();\n  const entryFile = fileService.getFirstExistingFile([join(mastraDir, 'index.ts'), join(mastraDir, 'index.js')]);\n\n  const bundler = new DevBundler(env);\n  bundler.__setLogger(createLogger(debug)); // Keep Pino logger for internal bundler operations\n\n  // Use the bundler's getAllToolPaths method to prepare tools paths\n  const discoveredTools = bundler.getAllToolPaths(mastraDir, tools ?? []);\n\n  const loadedEnv = await bundler.loadEnvVars();\n\n  // Clear any prior presets to avoid cross-run leakage\n  requestContextPresetsJson = undefined;\n  loadedEnv.delete('MASTRA_REQUEST_CONTEXT_PRESETS');\n  delete process.env.MASTRA_REQUEST_CONTEXT_PRESETS;\n\n  // spread loadedEnv into process.env\n  for (const [key, value] of loadedEnv.entries()) {\n    process.env[key] = value;\n  }\n\n  // Load and validate request context presets if provided\n  if (requestContextPresets) {\n    try {\n      requestContextPresetsJson = await loadAndValidatePresets(requestContextPresets);\n      // Add presets to loaded env so it's passed to the server\n      loadedEnv.set('MASTRA_REQUEST_CONTEXT_PRESETS', requestContextPresetsJson);\n    } catch (error) {\n      devLogger.error(`Failed to load request context presets: ${error instanceof Error ? error.message : error}`);\n      process.exit(1);\n    }\n  }\n\n  const serverOptions = await getServerOptions(entryFile, join(dotMastraPath, 'output'));\n  let portToUse = serverOptions?.port ?? process.env.PORT;\n  let hostToUse = serverOptions?.host ?? process.env.HOST ?? 'localhost';\n  const studioBasePathToUse = normalizeStudioBase(serverOptions?.studioBase ?? '/');\n\n  if (!portToUse || isNaN(Number(portToUse))) {\n    const portList = Array.from({ length: 21 }, (_, i) => 4111 + i);\n    portToUse = String(\n      await getPort({\n        port: portList,\n      }),\n    );\n  }\n\n  let httpsOptions: HTTPSOptions | undefined = undefined;\n\n  /**\n   * A user can enable HTTPS in two ways:\n   * 1. By passing the --https flag to the dev command (we then generate a cert for them)\n   * 2. By specifying https options in the mastra server config\n   *\n   * If both are specified, the config options takes precedence.\n   */\n  if (https && serverOptions?.https) {\n    devLogger.warn('--https flag and server.https config are both specified. Using server.https config.');\n  }\n  if (serverOptions?.https) {\n    httpsOptions = serverOptions.https;\n  } else if (https) {\n    const { key, cert } = await devcert.certificateFor(serverOptions?.host ?? 'localhost');\n    httpsOptions = { key, cert };\n  }\n\n  // Extract mastra packages from the project's package.json\n  const mastraPackages = await getMastraPackages(rootDir);\n\n  // Check for peer dependency version mismatches\n  const peerDepMismatches = await checkMastraPeerDeps(mastraPackages);\n  logPeerDepWarnings(peerDepMismatches);\n\n  const startOptions: StartOptions = {\n    inspect,\n    inspectBrk,\n    customArgs,\n    https: httpsOptions,\n    mastraPackages,\n    peerDepMismatches,\n  };\n\n  await bundler.prepare(dotMastraPath);\n\n  const watcher = await bundler.watch(entryFile, dotMastraPath, discoveredTools);\n\n  await startServer(\n    join(dotMastraPath, 'output'),\n    {\n      port: Number(portToUse),\n      host: hostToUse,\n      studioBasePath: studioBasePathToUse,\n      publicDir: join(mastraDir, 'public'),\n    },\n    loadedEnv,\n    startOptions,\n  );\n\n  watcher.on('event', (event: { code: string }) => {\n    if (event.code === 'BUNDLE_START') {\n      devLogger.bundling();\n    }\n    if (event.code === 'BUNDLE_END') {\n      devLogger.bundleComplete();\n      devLogger.info('[Mastra Dev] - Bundling finished, checking if restart is allowed...');\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      checkAndRestart(\n        dotMastraPath,\n        {\n          port: Number(portToUse),\n          host: hostToUse,\n          studioBasePath: studioBasePathToUse,\n          publicDir: join(mastraDir, 'public'),\n        },\n        bundler,\n        startOptions,\n      );\n    }\n  });\n\n  process.on('SIGINT', () => {\n    devLogger.shutdown();\n\n    if (currentServerProcess) {\n      currentServerProcess.kill();\n    }\n\n    watcher\n      .close()\n      .catch(() => {})\n      .finally(() => process.exit(0));\n  });\n}\n","import { analytics, origin } from '../..';\nimport { logger } from '../../utils/logger';\nimport { dev } from '../dev/dev';\n\ninterface DevArgs {\n  dir?: string;\n  root?: string;\n  tools?: string;\n  env?: string;\n  inspect?: string | boolean;\n  inspectBrk?: string | boolean;\n  customArgs?: string;\n  https?: boolean;\n  requestContextPresets?: string;\n  debug: boolean;\n}\n\nexport const startDevServer = async (args: DevArgs) => {\n  analytics.trackCommand({\n    command: 'dev',\n    origin,\n  });\n\n  dev({\n    dir: args?.dir,\n    root: args?.root,\n    tools: args?.tools ? args.tools.split(',') : [],\n    env: args?.env,\n    inspect: args?.inspectBrk ? false : args?.inspect,\n    inspectBrk: args?.inspectBrk,\n    customArgs: args?.customArgs ? args.customArgs.split(',') : [],\n    https: args?.https,\n    requestContextPresets: args?.requestContextPresets,\n    debug: args.debug,\n  }).catch(err => {\n    logger.error(err.message);\n  });\n};\n","import { spawn } from 'node:child_process';\nimport fs from 'node:fs';\nimport { join } from 'node:path';\nimport { config } from 'dotenv';\nimport { logger } from '../../utils/logger';\nimport { shouldSkipDotenvLoading } from '../utils';\ninterface StartOptions {\n  dir?: string;\n  env?: string;\n  customArgs?: string[];\n}\n\nexport async function start(options: StartOptions = {}) {\n  // Load environment variables from .env files\n  if (!shouldSkipDotenvLoading()) {\n    config({ path: [options.env || '.env.production', '.env'], quiet: true });\n  }\n  const outputDir = options.dir || '.mastra/output';\n\n  try {\n    // Check if the output directory exist\n    const outputPath = join(process.cwd(), outputDir);\n    if (!fs.existsSync(outputPath)) {\n      throw new Error(`Output directory ${outputPath} does not exist`);\n    }\n\n    const commands = [];\n\n    if (options.customArgs) {\n      commands.push(...options.customArgs);\n    }\n\n    commands.push('index.mjs');\n\n    // Start the server using node\n    const server = spawn(process.execPath, commands, {\n      cwd: outputPath,\n      stdio: ['inherit', 'inherit', 'pipe'],\n      env: {\n        ...process.env,\n        NODE_ENV: 'production',\n      },\n    });\n\n    let stderrBuffer = '';\n    server.stderr.on('data', data => {\n      stderrBuffer += data.toString();\n    });\n\n    server.on('exit', code => {\n      if (code !== 0 && stderrBuffer) {\n        if (stderrBuffer.includes('ERR_MODULE_NOT_FOUND')) {\n          const packageNameMatch = stderrBuffer.match(/Cannot find package '([^']+)'/);\n          const packageName = packageNameMatch ? packageNameMatch[1] : null;\n\n          if (!packageName) {\n            logger.error(stderrBuffer.trim());\n          } else {\n            logger.error(`Module \\`${packageName}\\` not found while starting the Mastra server.\nThis usually indicates that a transitive dependency could not be bundled correctly during the build process.\nTry adding \\`${packageName}\\` to your externals:\n\nexport const mastra = new Mastra({\n  bundler: {\n    externals: [\"${packageName}\"],\n  }\n})\n\nIf this doesn't resolve the issue, investigate the dependencies you added to your package.json as one of them might use \\`${packageName}\\` internally. Add that particular dependency to the externals instead. Also consider opening an issue.\n\nOriginal error:\n\n${stderrBuffer.trim()}`);\n          }\n        } else {\n          logger.error(stderrBuffer.trim());\n        }\n        process.exit(code);\n      }\n    });\n\n    server.on('error', err => {\n      logger.error(`Failed to start server: ${err.message}`);\n      process.exit(1);\n    });\n\n    process.on('SIGINT', () => {\n      server.kill('SIGINT');\n      process.exit(0);\n    });\n\n    process.on('SIGTERM', () => {\n      server.kill('SIGTERM');\n      process.exit(0);\n    });\n  } catch (error: any) {\n    logger.error(`Failed to start Mastra server: ${error.message}`);\n    process.exit(1);\n  }\n}\n","import { analytics, origin } from '../..';\nimport { start } from '../start';\n\nexport const startProject = async (args: { dir?: string; env?: string; customArgs?: string }) => {\n  await analytics.trackCommandExecution({\n    command: 'start',\n    args,\n    execution: async () => {\n      await start({\n        dir: args.dir,\n        env: args.env,\n        customArgs: args.customArgs ? args.customArgs.split(',') : [],\n      });\n    },\n    origin,\n  });\n};\n","import { existsSync, readFileSync } from 'node:fs';\nimport http from 'node:http';\nimport { dirname, join } from 'node:path';\nimport { fileURLToPath } from 'node:url';\nimport { config } from 'dotenv';\nimport handler from 'serve-handler';\nimport { logger } from '../../utils/logger';\nimport { loadAndValidatePresets, escapeJsonForHtml } from '../../utils/validate-presets.js';\n\ninterface StudioOptions {\n  env?: string;\n  port?: string | number;\n  serverHost?: string;\n  serverPort?: string | number;\n  serverProtocol?: string;\n  serverApiPrefix?: string;\n  requestContextPresets?: string;\n}\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n\nexport async function studio(\n  options: StudioOptions = {\n    serverHost: 'localhost',\n    serverPort: 4111,\n    serverProtocol: 'http',\n  },\n) {\n  // Load environment variables from .env files\n  config({ path: [options.env || '.env.production', '.env'], quiet: true });\n\n  // Load and validate request context presets if provided\n  let requestContextPresetsJson = '';\n  if (options.requestContextPresets) {\n    try {\n      requestContextPresetsJson = await loadAndValidatePresets(options.requestContextPresets);\n    } catch (error: any) {\n      logger.error(`Failed to load request context presets: ${error.message}`);\n      process.exit(1);\n    }\n  }\n\n  try {\n    const distPath = join(__dirname, 'studio');\n\n    if (!existsSync(distPath)) {\n      logger.error(`Studio distribution not found at ${distPath}.`);\n      process.exit(1);\n    }\n\n    const port = options.port || 3000;\n\n    // Start the server using the installed serve binary\n    // Start the server using node\n    const server = createServer(distPath, options, requestContextPresetsJson);\n\n    server.listen(port, () => {\n      logger.info(`Mastra Studio running on http://localhost:${port}`);\n    });\n\n    process.on('SIGINT', () => {\n      server.close(() => {\n        process.exit(0);\n      });\n    });\n\n    process.on('SIGTERM', () => {\n      server.close(() => {\n        process.exit(0);\n      });\n    });\n  } catch (error: any) {\n    logger.error(`Failed to start Mastra Studio: ${error.message}`);\n    process.exit(1);\n  }\n}\n\nconst createServer = (builtStudioPath: string, options: StudioOptions, requestContextPresetsJson: string) => {\n  const indexHtmlPath = join(builtStudioPath, 'index.html');\n  const basePath = '';\n\n  const experimentalFeatures = process.env.EXPERIMENTAL_FEATURES === 'true' ? 'true' : 'false';\n\n  let html = readFileSync(indexHtmlPath, 'utf8')\n    .replaceAll('%%MASTRA_STUDIO_BASE_PATH%%', basePath)\n    .replaceAll('%%MASTRA_SERVER_HOST%%', options.serverHost || 'localhost')\n    .replaceAll('%%MASTRA_SERVER_PORT%%', String(options.serverPort || 4111))\n    .replaceAll('%%MASTRA_SERVER_PROTOCOL%%', options.serverProtocol || 'http')\n    .replaceAll('%%MASTRA_API_PREFIX%%', options.serverApiPrefix || '/api')\n    .replaceAll('%%MASTRA_EXPERIMENTAL_FEATURES%%', experimentalFeatures)\n    .replaceAll('%%MASTRA_CLOUD_API_ENDPOINT%%', '')\n    .replaceAll('%%MASTRA_HIDE_CLOUD_CTA%%', '')\n    .replaceAll('%%MASTRA_TELEMETRY_DISABLED%%', process.env.MASTRA_TELEMETRY_DISABLED ?? '')\n    .replaceAll('%%MASTRA_REQUEST_CONTEXT_PRESETS%%', escapeJsonForHtml(requestContextPresetsJson));\n\n  const server = http.createServer((req, res) => {\n    const url = req.url || basePath;\n\n    // Let static assets be served by serve-handler\n    const isStaticAsset = url.includes('/assets/') || url.includes('/dist/assets/') || url.includes('/mastra.svg');\n\n    // For everything that's not a static asset, serve the SPA shell (index.html)\n    if (!isStaticAsset) {\n      res.writeHead(200, { 'Content-Type': 'text/html' });\n      return res.end(html);\n    }\n\n    return handler(req, res, {\n      public: builtStudioPath,\n    });\n  });\n\n  return server;\n};\n","import { analytics, origin } from '../..';\nimport { studio } from '../studio';\n\ninterface StudioArgs {\n  port?: string | number;\n  env?: string;\n  serverHost?: string;\n  serverPort?: string | number;\n  serverProtocol?: string;\n  serverApiPrefix?: string;\n  requestContextPresets?: string;\n}\n\nexport const startStudio = async (args: StudioArgs) => {\n  analytics.trackCommand({\n    command: 'studio',\n    origin,\n  });\n\n  await studio(args);\n};\n","#! /usr/bin/env node\nimport { Command } from 'commander';\nimport pc from 'picocolors';\nimport type { PackageJson } from 'type-fest';\n\nimport pkgJson from '../package.json';\nimport type { CLI_ORIGIN } from './analytics/index';\nimport { PosthogAnalytics, setAnalytics } from './analytics/index';\nimport { addScorer } from './commands/actions/add-scorer';\nimport { buildProject } from './commands/actions/build-project';\nimport { createProject } from './commands/actions/create-project';\nimport { initProject } from './commands/actions/init-project';\nimport { lintProject } from './commands/actions/lint-project';\nimport { listScorers } from './commands/actions/list-scorers';\nimport { migrate } from './commands/actions/migrate';\nimport { startDevServer } from './commands/actions/start-dev-server';\nimport { startProject } from './commands/actions/start-project';\nimport { startStudio } from './commands/actions/start-studio';\nimport { COMPONENTS, LLMProvider } from './commands/init/utils';\nimport { parseComponents, parseLlmProvider, parseMcp, parseSkills } from './commands/utils';\n\nconst mastraPkg = pkgJson as PackageJson;\nexport const version = mastraPkg.version;\n\nexport const analytics = new PosthogAnalytics({\n  apiKey: 'phc_SBLpZVAB6jmHOct9CABq3PF0Yn5FU3G2FgT4xUr2XrT',\n  host: 'https://us.posthog.com',\n  version: version!,\n});\n\nsetAnalytics(analytics);\n\nconst program = new Command();\n\nexport const origin = process.env.MASTRA_ANALYTICS_ORIGIN as CLI_ORIGIN;\n\nprogram\n  .name('mastra')\n  .version(`${version}`, '-v, --version')\n  .addHelpText(\n    'before',\n    `\n${pc.bold(pc.cyan('Mastra'))} is a typescript framework for building AI applications, agents, and workflows.\n`,\n  )\n  .action(() => {\n    program.help();\n  });\n\nprogram\n  .command('create [project-name]')\n  .description('Create a new Mastra project')\n  .option('--default', 'Quick start with defaults (src, OpenAI, examples)')\n  .option(\n    '-c, --components <components>',\n    `Comma-separated list of components (${COMPONENTS.join(', ')})`,\n    parseComponents,\n  )\n  .option('-l, --llm <model-provider>', `Default model provider (${LLMProvider.join(', ')})`, parseLlmProvider)\n  .option('-k, --llm-api-key <api-key>', 'API key for the model provider')\n  .option('-e, --example', 'Include example code')\n  .option('-n, --no-example', 'Do not include example code')\n  .option('-t, --timeout [timeout]', 'Configurable timeout for package installation, defaults to 60000 ms')\n  .option('-d, --dir <directory>', 'Target directory for Mastra source code (default: src/)')\n  .option(\n    '-p, --project-name <string>',\n    'Project name that will be used in package.json and as the project directory name.',\n  )\n  .option(\n    '-m, --mcp <editor>',\n    'MCP Server for code editor (cursor, cursor-global, windsurf, vscode, antigravity)',\n    parseMcp,\n  )\n  .option('--skills <agents>', 'Install Mastra agent skills for specified agents (comma-separated)', parseSkills)\n  .option(\n    '--template [template-name]',\n    'Create project from a template (use template name, public GitHub URL, or leave blank to select from list)',\n  )\n  .action(createProject);\n\nprogram\n  .command('init')\n  .description('Initialize Mastra in your project')\n  .option('--default', 'Quick start with defaults (src, OpenAI, examples)')\n  .option('-d, --dir <directory>', 'Directory for Mastra files to (defaults to src/)')\n  .option(\n    '-c, --components <components>',\n    `Comma-separated list of components (${COMPONENTS.join(', ')})`,\n    parseComponents,\n  )\n  .option('-l, --llm <model-provider>', `Default model provider (${LLMProvider.join(', ')})`, parseLlmProvider)\n  .option('-k, --llm-api-key <api-key>', 'API key for the model provider')\n  .option('-e, --example', 'Include example code')\n  .option('-n, --no-example', 'Do not include example code')\n  .option(\n    '-m, --mcp <editor>',\n    'MCP Server for code editor (cursor, cursor-global, windsurf, vscode, antigravity)',\n    parseMcp,\n  )\n  .action(initProject);\n\nprogram\n  .command('lint')\n  .description('Lint your Mastra project')\n  .option('-d, --dir <path>', 'Path to your Mastra folder')\n  .option('-r, --root <path>', 'Path to your root folder')\n  .option('-t, --tools <toolsDirs>', 'Comma-separated list of paths to tool files to include')\n  .action(lintProject);\n\nprogram\n  .command('dev')\n  .description('Start mastra server')\n  .option('-d, --dir <dir>', 'Path to your mastra folder')\n  .option('-r, --root <root>', 'Path to your root folder')\n  .option('-t, --tools <toolsDirs>', 'Comma-separated list of paths to tool files to include')\n  .option('-e, --env <env>', 'Custom env file to include in the dev server')\n  .option(\n    '-i, --inspect [host:port]',\n    'Start the dev server in inspect mode (optional: [host:]port, e.g., 0.0.0.0:9229)',\n  )\n  .option(\n    '-b, --inspect-brk [host:port]',\n    'Start the dev server in inspect mode and break at the beginning of the script (optional: [host:]port)',\n  )\n  .option(\n    '-c, --custom-args <args>',\n    'Comma-separated list of custom arguments to pass to the dev server. IE: --experimental-transform-types',\n  )\n  .option('-s, --https', 'Enable local HTTPS')\n  .option('--request-context-presets <file>', 'Path to request context presets JSON file')\n  .option('--debug', 'Enable debug logs', false)\n  .action(startDevServer);\n\nprogram\n  .command('build')\n  .description('Build your Mastra project')\n  .option('-d, --dir <path>', 'Path to your Mastra Folder')\n  .option('-r, --root <path>', 'Path to your root folder')\n  .option('-t, --tools <toolsDirs>', 'Comma-separated list of paths to tool files to include')\n  .option('-s, --studio', 'Bundle the studio UI with the build')\n  .option('--debug', 'Enable debug logs', false)\n  .action(buildProject);\n\nprogram\n  .command('start')\n  .description('Start your built Mastra application')\n  .option('-d, --dir <path>', 'Path to your built Mastra output directory (default: .mastra/output)')\n  .option('-e, --env <env>', 'Custom env file to include in the start')\n  .option(\n    '-c, --custom-args <args>',\n    'Comma-separated list of custom arguments to pass to the Node.js process. IE: --require=newrelic',\n  )\n  .action(startProject);\n\nprogram\n  .command('studio')\n  .description('Start the Mastra studio')\n  .option('-p, --port <port>', 'Port to run the studio on (default: 3000)')\n  .option('-e, --env <env>', 'Custom env file to include in the studio')\n  .option('-h, --server-host <serverHost>', 'Host of the Mastra API server (default: localhost)')\n  .option('-s, --server-port <serverPort>', 'Port of the Mastra API server (default: 4111)')\n  .option('-x, --server-protocol <serverProtocol>', 'Protocol of the Mastra API server (default: http)')\n  .option('--server-api-prefix <serverApiPrefix>', 'API route prefix of the Mastra server (default: /api)')\n  .option('--request-context-presets <file>', 'Path to request context presets JSON file')\n  .action(startStudio);\n\nprogram\n  .command('migrate')\n  .description('Run database migrations to update storage schema')\n  .option('-d, --dir <path>', 'Path to your Mastra folder')\n  .option('-r, --root <path>', 'Path to your root folder')\n  .option('-e, --env <env>', 'Custom env file to include')\n  .option('--debug', 'Enable debug logs', false)\n  .option('-y, --yes', 'Skip confirmation prompt (for CI/automation)')\n  .action(migrate);\n\nconst scorersCommand = program.command('scorers').description('Manage scorers for evaluating AI outputs');\n\nscorersCommand\n  .command('add [scorer-name]')\n  .description('Add a new scorer to your project')\n  .option('-d, --dir <path>', 'Path to your Mastra directory (default: auto-detect)')\n  .action(addScorer);\n\nscorersCommand.command('list').description('List available scorer templates').action(listScorers);\n\nprogram.parse(process.argv);\n\nexport { PosthogAnalytics } from './analytics/index';\nexport { create } from './commands/create/create';\n"]}